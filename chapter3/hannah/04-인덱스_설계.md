### 인덱스 설계

**인덱스 설계가 어려운 이유**

- 인덱스가 많으면 생기는 문제들
    - DML 성능 저하 (→ TPS 저하)
    - 데이터베이스 사이즈 증가 (→ 디스크 공간 낭비)
    - 데이터베이스 관리 및 운영 비용 상승
- 테이블에 인덱스가 6개 달려 있으면 신규 데이터를 입력할 때마다 6개 인덱스에도 데이터를 입력해야한다
- 인덱스는 정렬 상태를 유지해야 하므로 수직적 탐색을 통해 입력할 블록부터 찾는다
    - 찾은 블록에 여유 공간이 없으면 인덱스 분할(Index Split)도 발생한다
    - Index Split : [https://pangsun.co.kr/entry/Index-Split-이란](https://pangsun.co.kr/entry/Index-Split-%EC%9D%B4%EB%9E%80)

**가장 중요한 두 가지 선택 기준**

결합 인덱스를 구성할 때의 기준

1. 조건절에 항상 사용하거나, 자주 사용한느 컬럼을 선정한다
2. ‘=’ 조건으로 자주 조회하는 컬럼을 앞쪽에 둔다

**스캔 효율성 이외의 판단 기준**

- 수행 빈도
- 업무상 중요도
- 클러스터링 팩터
- 데이터량
- DML 부하 (= 기존 인덱스 개수, 초당 DML 발생략, 자주 갱신하는 컬럼 포함 여부 등)
- 저장 공간
- 인덱스 관리 비용 등

이 중 하나를 꼽으라면 수행 빈도가 아닐까 싶다(저자의 개인적인 생각)

**소트 연산을 생략하기 위한 컬럼 추가**

음 뭔가 pk가 있어서 사실상 소트 연산을 생략하기 위해 인덱스를 건다? 는 것은 필요 없지 않나 싶은 생각이 든다 보통은 … pk 기준으로 정렬하니까… 얘가 만들어진 순서도 그렇고… 머…

**결합 인덱스 선택도**

- 인덱스 생성 여부를 결정할 때는 선택도가 충분히 낮은지가 중요한 판단기준임
- ‘선택도(selecttivity)’란 전체 레코드 중에서 조건절에 의해 선택되는 레코드 비율을 말하며, 선택도에 총 레코드 수를 곱해서 ‘카디널리티’를 구한다 (테이블 액세스 최소화시켜야함)
- → 인덱스를 생성할 때는 반드시 선택도/카디널리티를 확인해야 한다
- 컬럼 순서 결정 시, 선택도 이슈
    - 인덱스 설계할 때 우리가 할 일은 ‘항상 사용하는’ 컬럼을 앞쪽에 두고 그 중 ‘=’ 조건을 앞쪽에 위치시키는 것뿐이다
    - 조건절에서 누락되거나 범위 검색 조건일 수 있다면  얘기가 복잡해진다
- → 인덱스 생성 여부를 결정할 때는 선택도가 매우 중요하지만, 컬럼 간 순서를 결정할 때는 각 컬럼의 선택도보다 필수 조건 여부, 연산자 형태가 더 중요한 판단 기준이다
